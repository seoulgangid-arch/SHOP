<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seoulgang ID - SHOP</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Fredoka+One&display=swap" rel="stylesheet">
<style>
/* ... semua CSS kamu tetap sama ... */
</style>
</head>
<body>
<h2 class="welcome-text">Welcome to Seoulgang ID! Have fun shopping with us</h2>

<div class="container">
    <h1>Sign in with Google</h1>
    <div id="g_id_onload" data-client_id="314703538838-cp2nm11deeirrtus11290r46v4ugeqdq.apps.googleusercontent.com" data-callback="handleCredentialResponse" data-auto_prompt="false"></div>
    <div class="g_id_signin" data-type="standard" data-theme="outline" data-size="large" data-text="signin_with" data-logo_alignment="left"></div>

    <div class="register-text" onclick="showRegisterForm()">Register with Gmail</div>
    <div id="register-form">
        <input type="email" id="register-email" placeholder="Enter your Gmail" required>
        <button onclick="submitRegister()">Submit</button>
    </div>
</div>

<div class="emoji-rain" id="emoji-rain"></div>

<div id="popup">
    <p id="popup-message">Message here</p>
    <button id="popup-close">Close</button>
</div>

<script src="https://accounts.google.com/gsi/client" async defer></script>
<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzLdcmhho1yCRDRqBv7YcY0JaHhJmLG3yHEMUUBYR5JgWXAKcZhBXzQL9TIk-R5Rmgs/exec";
const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdra6gvbX3oCHll9EPk4fUZCpAm9J0Npa-WZwBT9ThyjUvI8g/formResponse";

function popupMsg(msg){
    const popup = document.getElementById("popup");
    const msgEl = document.getElementById("popup-message");
    msgEl.textContent = msg;
    popup.style.display = "block";
    popup.style.opacity = 0;
    popup.animate([{opacity:0},{opacity:1}],{duration:300,fill:'forwards'});
}

function showRegisterForm(){
    const form = document.getElementById("register-form");
    form.style.display = "flex";
    form.style.opacity = 0;
    form.animate([{opacity:0},{opacity:1}],{duration:500,fill:'forwards'});
}

function submitRegister(){
    const email = document.getElementById("register-email").value.trim();
    if(!email || !email.toLowerCase().endsWith("@gmail.com")){
        popupMsg("Invalid Gmail!");
        return;
    }

    fetch(WEB_APP_URL+"?email="+encodeURIComponent(email))
    .then(res => res.text())
    .then(status => {
        if(status === "duplicate"){
            popupMsg("Email already exists. Cannot register again 😡");
        } else if(status === "approved"){
            popupMsg("User already registered 😎");
        } else {
            submitToGoogleForm(email);
        }
    })
    .catch(err => {
        popupMsg("Error contacting server. Try again later!");
        console.error(err);
    });
}

function submitToGoogleForm(email){
    const formData = new FormData();
    formData.append("entry.1841453535", email);
    fetch(GOOGLE_FORM_URL, {method:"POST", body: formData, mode:"no-cors"})
    .then(()=>{
        popupMsg(`Cheers, ${email}! 🍾 Your registration is submitted successfully!`);
        document.getElementById("register-email").value = "";
        document.getElementById("register-form").style.display = "none";
    });
}

document.getElementById("popup-close").addEventListener("click",()=>{
    const popup = document.getElementById("popup");
    popup.animate([{opacity:1},{opacity:0}],{duration:300,fill:'forwards'});
    setTimeout(()=>{ popup.style.display = "none"; },300);
});

// Emoji DVD-style bounce background
const emojiList = ["🛒","🛍️","🏷️","🔖","👜","👝","🎁","🎀","👗","👚","👕","👖","👔","👙","👟","👠","👡","👢","👒","🎩","🧢","👓","🕶️","🧤","🧣","🧦","👛","💄","💍","⌚","🏬","🏪","💳","💵","💰","🪙","💸","📦","🥡","🍫","🍷"];
const rainContainer = document.getElementById("emoji-rain");
const emojis = [];
for(let i=0;i<25;i++){
    const div = document.createElement("div");
    div.className = "emoji";
    div.textContent = emojiList[Math.floor(Math.random()*emojiList.length)];
    const size = 25 + Math.random()*20;
    div.style.fontSize = size + "px";
    rainContainer.appendChild(div);
    emojis.push({el:div,x:Math.random()*(window.innerWidth-size),y:Math.random()*(window.innerHeight-size),vx:(Math.random()*0.5+0.3)*(Math.random()<0.5?-1:1),vy:(Math.random()*0.5+0.3)*(Math.random()<0.5?-1:1),size:size});
}
function animateEmojis(){
    emojis.forEach(e=>{
        e.x += e.vx; e.y += e.vy;
        if(e.x<0){ e.x=0; e.vx*=-1; }
        if(e.x+e.size>window.innerWidth){ e.x=window.innerWidth-e.size; e.vx*=-1; }
        if(e.y<0){ e.y=0; e.vy*=-1; }
        if(e.y+e.size>window.innerHeight){ e.y=window.innerHeight-e.size; e.vy*=-1; }
        e.el.style.transform = `translate(${e.x}px,${e.y}px)`;
    });
    requestAnimationFrame(animateEmojis);
}
animateEmojis();
</script>
</body>
</html>
